<link rel="import" href="../node_modules/core-ajax-npm/core-ajax.html">
<link rel="import" href="../node_modules/ui-tooltip/src/ui-tooltip.html">
<polymer-element name="glg-compliance-blinky" attributes="cmId projectId contactId ruleSet">
  <template>
    <link rel="stylesheet" type="text/css" href="./glg-compliance-blinky.less">
    <core-ajax
      auto
      url="https://services.glgresearch.com/compliance-epi/api/{{ruleSet}}validate/"
      params='{"src":"glg-compliance-blinky","cmIds":"{{cmId}}","projectId":"{{projectId}}","contactId":"{{contactId}}"}'
      handleAs="json"
      withCredentials="true"
      on-core-response="{{onResponse}}"
      on-core-error="{{onError}}"
      on-core-complete="{{onComplete}}"></core-ajax>

    <ui-tooltip display="right down">
      <span tip>{{tooltip}}</span>
      <div class="blinky good" hidden?="{{working || hold || blocked || errored}}"></div>

      <div class="blinky hold" hidden?="{{working || !hold || blocked || errored}}"></div>

      <div class="blinky blocked" hidden?="{{working || !blocked || errored}}"></div>

      <div class="blinky errored" hidden?="{{working || !errored}}"></div>
    </ui-tooltip>

    <div class="blinky working" hidden?="{{!working}}">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="1em" height="1em">
        <path transform="translate(2)" d="M0 12 V20 H4 V12z">
          <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline"  />
        </path>
        <path transform="translate(8)" d="M0 12 V20 H4 V12z">
          <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.2" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline"  />
        </path>
        <path transform="translate(14)" d="M0 12 V20 H4 V12z">
          <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.4" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline" />
        </path>
        <path transform="translate(20)" d="M0 12 V20 H4 V12z">
          <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.6" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline" />
        </path>
        <path transform="translate(26)" d="M0 12 V20 H4 V12z">
          <animate attributeName="d" values="M0 12 V20 H4 V12z; M0 4 V28 H4 V4z; M0 12 V20 H4 V12z; M0 12 V20 H4 V12z" dur="1.2s" repeatCount="indefinite" begin="0.8" keytimes="0;.2;.5;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.8 0.4 0.8" calcMode="spline" />
        </path>
      </svg>
    </div>
  </template>
  <script src="./glg-compliance-blinky.litcoffee"></script>
</polymer-element>
